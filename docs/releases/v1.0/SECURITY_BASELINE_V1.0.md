# Security Baseline - V1.0

## 1. 目标

建立 `V1.0` 最小可执行安全基线，覆盖密钥、访问、日志、依赖与发布流程。

## 2. 数据分级与处理原则

- 敏感信息：密钥、令牌、数据库密码
- 业务输入：用户消息（默认按敏感处理）
- 处理原则：
  - 最小采集
  - 最小暴露
  - 最小保留

## 3. 密钥与凭据管理

- 密钥仅通过环境变量或 Secret Manager 注入
- 禁止将真实密钥写入代码、文档、截图
- `.env` 仅用于本地开发，禁止提交生产凭据
- 凭据轮换周期：建议每 90 天

## 4. 访问控制基线

- 环境隔离：`dev/staging/prod`
- 最小权限访问数据库与缓存
- 运维操作需留痕（发布、回滚、配置变更）

## 5. API 安全基线

- 严格参数校验（Pydantic）
- 统一错误响应，不泄露内部堆栈给客户端
- 请求超时保护必须启用
- CORS 白名单最小化配置

## 6. 日志与隐私

- 日志使用结构化 JSON
- 禁止记录明文密钥、令牌、密码
- 用户输入日志需做截断或脱敏
- `request_id` 必须保留，用于排障追踪

## 7. 依赖与供应链

- 后端依赖定期漏洞扫描（如 `pip-audit`）
- 前端依赖定期漏洞扫描（如 `pnpm audit`）
- CI 阶段加入依赖安全检查（后续接入）

## 8. 发布安全门禁

发布前至少确认：

- 无高危未处置漏洞（High/Critical）
- 关键配置未使用默认弱口令
- 安全相关环境变量已正确注入
- 回滚路径可执行

## 9. 安全事件响应

1. 发现异常后立即隔离影响范围
2. 旋转疑似泄露凭据
3. 审核访问日志与变更记录
4. 修复并验证
5. 形成复盘与改进项

