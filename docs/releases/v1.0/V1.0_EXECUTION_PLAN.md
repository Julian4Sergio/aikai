# V1.0 执行计划（文档优先）

## 1. 目标

将 `docs/releases/v1.0/V1.0_DESIGN_BASELINE.md` 转化为可执行任务，确保实现前即明确：

- 任务边界
- 验收标准
- 测试策略
- 回滚策略

## 2. 执行顺序（第一步到可验收）

1. 契约冻结
2. 架构骨架搭建
3. 核心链路实现
4. 观测与错误基线补齐
5. 测试与验收

## 3. 工作分解（WBS）

## 3.1 契约冻结（优先级 P0）

- 输出 `Chat API` 契约草案（`POST /api/v1/chat/completions`）
- 输出健康检查契约（`GET /healthz`）
- 明确错误码最小集合（参数非法、超时、内部错误）
- 确认字段保留策略：`tenant_id`、`edition`

完成标准：

- 接口请求/响应字段固定
- 错误码命名与语义固定
- 评审通过并记录在文档

## 3.2 架构骨架搭建（优先级 P0）

- 后端模块目录按边界创建：`chat`、`memory`、`knowledge`、`tooling`
- 仅启用 `chat` 路径，其他模块为占位扩展点
- 前端创建极简聊天页骨架（输入、发送、结果、错误展示）

完成标准：

- 目录边界可见且不混用
- 前后端本地可启动

## 3.3 核心链路实现（优先级 P0）

- 打通前端到后端单轮问答链路
- 接口默认 `edition=personal`
- 请求落结构化日志并生成 `request_id`

完成标准：

- 用户可完成一次提问并收到回答
- 请求日志可按 `request_id` 追踪

## 3.4 观测与错误基线（优先级 P0）

- 为接口加超时保护
- 错误统一映射稳定错误码
- 返回结构统一：成功/失败均带 `request_id`

完成标准：

- 超时行为一致且可预测
- 常见失败场景返回明确错误

## 3.5 测试与验收（优先级 P0）

- 单元测试：参数校验、错误码映射、超时分支
- 集成测试：`chat/completions` 与 `healthz`
- 手工联调：输入、加载、成功、错误态

完成标准：

- 核心测试通过
- 满足 `docs/foundation/ROADMAP.md` 中 `V1.0` 验收条目

## 4. 任务卡模板（用于 issue/PR）

每个任务卡至少包含以下字段：

- 背景
- 范围（In Scope）
- 非范围（Out of Scope）
- 接口或行为变更
- 验收标准
- 测试计划
- 回滚说明

## 5. 验收清单（Checklist）

- [ ] 单轮问答链路可用
- [ ] 前后端本地可运行
- [ ] 每次请求有结构化日志
- [ ] API 具备超时处理
- [ ] 关键异常映射稳定错误码
- [ ] 核心模型包含 `tenant_id`
- [ ] 系统配置保留 `edition`
- [ ] `chat` 外模块仅占位不启用
- [ ] 文档与实现一致

## 6. 风险与缓解

- 风险：先实现后补契约，导致返工  
  缓解：先冻结契约，再写代码

- 风险：模块边界被快捷实现绕过  
  缓解：目录级边界 + 评审时强制检查

- 风险：错误处理不统一影响联调  
  缓解：先定义错误码和错误响应结构

## 7. 里程碑建议（2 周 Sprint）

- 第 1-2 天：契约冻结与评审
- 第 3-6 天：骨架与核心链路实现
- 第 7-9 天：错误/超时/日志补齐
- 第 10 天：测试、验收、文档回收

## 8. 关联文档

- `docs/releases/v1.0/V1.0_DESIGN_BASELINE.md`
- `docs/foundation/PRD-v1.md`
- `docs/foundation/ROADMAP.md`
- `docs/foundation/ARCHITECTURE_GUARDRAILS.md`
- `docs/foundation/DEV_WORKFLOW.md`

