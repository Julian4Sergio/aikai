# V1.1 设计基线（Scope Freeze）

## 1. 文档目的

冻结 `V1.1` 的目标、范围与验收口径，作为评审、实现、测试与发布的统一输入。

## 2. 版本目标

- 在 `V1.0` 稳定基线之上，优先提升用户体验
- 通过 `SSE` 流式传输降低“等待整段回答”的体感时延
- 在不破坏 `V1.0` 兼容性的前提下引入短窗口多轮会话能力

## 3. 版本拆分

- `V1.1.0`：体验底座（流式 + 取消 + 指标）
- `V1.1.1`：会话增强（短窗口 history + 连续性前端交互）

## 4. 范围（In Scope）

### 4.1 V1.1.0

- 新增流式问答接口（`SSE`）
- 前端增量渲染（边生成边展示）
- 生成中止/取消交互与后端中止链路
- 体验指标采集（`TTFT`、流式成功率、取消可控结束率）
- 保留 `V1.0` 同步接口作为兼容路径

### 4.2 V1.1.1

- 短窗口 `history` 注入（最近 N 轮）
- 会话连续性最小交互（续聊、刷新恢复）
- 流式+多轮组合场景回归

## 5. 非范围（Out of Scope）

- 长期记忆
- 知识库检索（RAG）
- MCP 工具调用
- 复杂租户与组织权限治理

## 6. 架构约束与边界

- 保持模块化单体与既有目录边界不变
- 同步与流式共享同一生成核心逻辑，避免双实现分叉
- `V1.0` 契约持续可用，不做破坏性变更
- 继续保留 `tenant_id`、`edition` 字段语义

## 7. 最小接口策略

- 保留：`POST /api/v1/chat/completions`（同步 JSON）
- 新增：`POST /api/v1/chat/stream`（`SSE`）
- 维持：`GET /healthz`

## 8. 验收标准（DoD）

- 用户可在前端看到流式增量输出
- 用户可在生成中取消，系统可控结束
- 同步接口回归通过且行为与 `V1.0` 一致
- 短窗口多轮在 `V1.1.1` 可用且不引入主链路回归
- 文档、测试、实现三者一致

## 9. 追踪来源

- `docs/releases/v1.1/V1.1_BACKLOG_FROM_V1.0.md`
- `docs/releases/v1.1/V1.1_EXECUTION_PLAN.md`
- `docs/foundation/PRD-v1.md`
- `docs/foundation/ROADMAP.md`
